<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
  </style>
</head>

<body>

</body>

</html>
<script src="./pixi.js"></script>
<script>
  //Aliases
  var Container = PIXI.Container,
    autoDetectRenderer = PIXI.autoDetectRenderer,
    loader = PIXI.loader,
    resources = PIXI.loader.resources,
    TextureCache = PIXI.utils.TextureCache,
    Texture = PIXI.Texture,
    Sprite = PIXI.Sprite;

  //Create a Pixi stage and renderer and add the 
  //renderer.view to the DOM
  var stage = new Container(),
    renderer = autoDetectRenderer(512, 512);
  document.body.appendChild(renderer.view);

  //load a JSON file and run the `setup` function when it's done
  loader
    .add("img/treasureHunter.json")
    .load(setup);

  //Define variables that might be used in more 
  //than one function
  var dungeon, explorer, treasure, door, id;

  function setup() {

    //There are 3 ways to make sprites from textures atlas frames

    //1. Access the `TextureCache` directly
    var dungeonTexture = TextureCache["dungeon.png"];
    dungeon = new Sprite(dungeonTexture);
    stage.addChild(dungeon);

    //2. Access the texture using throuhg the loader's `resources`:
    explorer = new Sprite(
      resources["img/treasureHunter.json"].textures["explorer.png"]
    );
    explorer.x = 68;

    //Center the explorer vertically
    explorer.y = stage.height / 2 - explorer.height / 2;
    stage.addChild(explorer);

    //3. Create an optional alias called `id` for all the texture atlas 
    //frame id textures.
    id = PIXI.loader.resources["img/treasureHunter.json"].textures;

    //Make the treasure box using the alias
    treasure = new Sprite(id["treasure.png"]);
    stage.addChild(treasure);

    //Position the treasure next to the right edge of the canvas
    treasure.x = stage.width - treasure.width - 48;
    treasure.y = stage.height / 2 - treasure.height / 2;
    stage.addChild(treasure);

    //Make the exit door
    door = new Sprite(id["door.png"]);
    door.position.set(32, 0);
    stage.addChild(door);

    //Make the blobs
    var numberOfBlobs = 4,
      spacing = 48,
      xOffset = 150;

    //Make as many blobs as there are `numberOfBlobs`
    for (var i = 0; i < numberOfBlobs; i++) {

      //Make a blob
      var blob = new Sprite(id["blob.png"]);

      //Space each blob horizontally according to the `spacing` value.
      //`xOffset` determines the point from the left of the screen
      //at which the first blob should be added.
      var x = spacing * i + xOffset;

      //Give the blob a random y position
      //(`randomInt` is a custom function - see below)
      var y = randomInt(0, stage.height - blob.height);

      //Set the blob's position
      blob.x = x;
      blob.y = y;

      //Add the blob sprite to the stage
      stage.addChild(blob);
      console.log('blob: ', blob);
    }

    //Render the stage   
    renderer.render(stage);
  }

  //The `randomInt` helper function
  function randomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }
</script>

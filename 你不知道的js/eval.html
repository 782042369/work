<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>

<body>
</body>

</html>
<script>
  // 在执行 eval(..) 之后的代码时，引擎并不“知道”或“在意”前面的代码是以动态形式插入进来
  // 并对词法作用域的环境进行修改的。引擎只会如往常地进行词法作用域查找。
  // function foo(str, a) {
  //   eval(str); // 欺骗! 
  //   console.log(a, b);
  // }
  // var b = 2;
  // foo("var b = 3;", 1); // 1, 3

  // function foo(str) {
  //   "use strict";
  //   eval(str);
  //   console.log(a); // ReferenceError: a is not defined
  // }
  // foo("var a = 2");


  function foo(obj) {
    with(obj) {
      a = 2;
    }
  }
  var o1 = {
    a: 3
  };
  var o2 = {
    b: 3
  };
  foo(o1);
  console.log(o1.a); // 2
  foo(o2);
  console.log(o2.a); // undefined
  console.log(a); // 2——不好，a 被泄漏到全局作用域上了!
</script>
